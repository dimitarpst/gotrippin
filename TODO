
Todo:
  ✔ Centralize getAuthToken() — single helper for api/trips.ts, api/weather.ts, api/activities.ts, api/trip-locations.ts
  ✔ Move date helpers to @gotrippin/core — formatTripDate, calculateDaysUntil, calculateDuration
  ✔ Remove localStorage — no localStorage; use session/cookies (i18n, AuthContext, Supabase uses cookies)
  ✔ Extract chains/booleans — trips-list.tsx, location-card.tsx, AvatarUpload.tsx
  ✔ Avatar picker shows all uploaded avatars — fix isMounted guard blocking setUserAvatarFiles on storage list success
  ✔ Cross-platform audit — ensure same data/behavior for web + mobile (review BACKEND_FRONTEND_MOBILE_AUDIT.md, fix inconsistencies)

Phase 1.1 — Cross-platform audit (step-by-step):
  ✔ Update stale audit doc — getAuthToken centralization, date helpers, profiles decision (Supabase direct)
  ✔ Review per section — walk through NestJS, frontend API, Supabase usage, gaps
  ✔ Identify inconsistencies — list mismatches between web + mobile expectations
  ✔ Decide and document — keep web as-is; items 1–4 addressed when building RN
  ✔ Implement fixes — none needed for web
  ✔ Mark audit complete

Phase 2 — Architecture:
  ✔ Server Components for trip list — fetch trips on server, pass to client
  ✔ Server Components for trip detail — fetch trip + locations + timeline + weather on server
  ✔ Server Actions for mutations — trip create/update/delete
  ✔ Simplify TripOverview — grouped props: actions, timeline, weather (was ~25 flat props)

Phase 4+:
  ✔ Image pipeline — avatars on Cloudflare R2; key-based storage (not full URLs); resolveAvatarUrl helper
  ☐ More Server Components — user profile, other pages

Phase 4.1 — Trip cover images (photos table + R2):
  ☐ DB: photos table — storage_key, source (unsplash|upload), unsplash_photo_id, photographer_name, photographer_url, blur_hash (required for unsplash)
  ☐ DB: trips.cover_photo_id FK to photos; migrate existing image_url
  ☐ Backend: download Unsplash image → R2, track download, create photo row
  ☐ Frontend: picker saves via new flow; resolve cover URL from photo
  ☐ Shared loading/error patterns — reusable PageLoader, PageError
  ☐ Code style doc — readable-code rules for future PRs
  ☐ Maps integration — Mapbox + coordinates (MAPS_IMPLEMENTATION.md)

Phase 5 — Public Trip Sharing (later):
  ☐ Add color picker — replace native input[type=color] in profile (shadcn has no built-in; use Popover + react-colorful or similar)
  ☐ Per-trip visibility toggle — Private (auth required) vs Anyone with link (view without login)
  ☐ DB: add visibility field to trips
  ☐ NestJS: GET /trips/share/:shareCode returns public trips without auth
  ☐ Read-only layout — minimal UI for unauthenticated viewers (no DockBar, no edit, CTA to sign up)
  ☐ RLS: allow unauthenticated select for public trips
